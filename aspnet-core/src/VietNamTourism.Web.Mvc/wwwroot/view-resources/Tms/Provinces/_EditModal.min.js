(function ($) {
	app.modals.ProvincesEditModal = function () {
		var _modalManager;
		var _$form = null;
		var _provinceAppService = abp.services.app.provinces;
		var _$table = $("#ProvincesTable");
		this.init = function (modalManager) {
			_modalManager = modalManager;

			_$form = _modalManager.getModal().find('#ProvincesEditForm');

			_$form.validate({
				rules: {
					Name: {
						required: true,
						minlength: 2,
					},
					DisplayName: {
						required: true,
						minlength: 2,
					}
				},
				messages: {
					Name: {
						required: abp.localization.localize("PleaseEnterAName", "VietNamTourism"),
						minlength: abp.localization.localize("NameMustConsistOfAtLeast2Characters", "VietNamTourism")
					},
					DisplayName: {
						required: abp.localization.localize("PleaseEnterADisplayName", "VietNamTourism"),
						minlength: abp.localization.localize("DisplayNameMustConsistOfAtLeast2Characters", "VietNamTourism")
					}
				},
				errorClass: "text-danger",
				errorPlacement: function (error, element) {
					error.insertAfter(element);
				}
			})

			this.save = function () {
				if (!_$form.valid()) {
					return;
				}
				_$form = _modalManager.getModal().find('#ProvincesEditForm');
				var dataInput = {};
				dataInput.Id = $("#Id").val();
				dataInput.Name = $("#Name").val();
				dataInput.DisplayName = $("#DisplayName").val();
				dataInput.Code = $("#CodeProvince").val();
				dataInput.Description = $("#Description").val();
				dataInput.Region = $("#Region").val();

				abp.ui.setBusy(_modalManager.getModal());

				_provinceAppService
					.editProvince(dataInput)
					.done(function (result) {
						abp.notify.info(abp.localization.localize("SavedSuccessfully"), "VietNamTourism");
						_modalManager.close();
						_$table.DataTable().ajax.reload();
					})
					.always(function () {
						abp.ui.clearBusy(_modalManager.getModal());
					});
			}
		}
	};
})(jQuery);